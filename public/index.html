<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Server stats</title>
  <style>
    table,
    td {
      border: 1px solid #333;
    }

    thead {
      background-color: #333;
      color: #fff;
    }
  </style>
</head>

<body>
  <h1>Server stats</h1>
  <table>
    <thead>
      <tr>
        <th colspan="2">Memory usage</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>RSS</td>
        <td id="rss"></td>
      </tr>
      <tr>
        <td>Heap total</td>
        <td id="heapTotal"></td>
      </tr>
      <tr>
        <td>Heap used</td>
        <td id="heapUsed"></td>
      </tr>
      <tr>
        <td>External</td>
        <td id="external"></td>
      </tr>
    </tbody>
  </table>

  <div id="root">
    <h1>Simple Chat App with geckos.io</h1>

    <form onsubmit="return false;">
      <input type="text" name="text" id="text" value="" />
      <!-- <input type="button" value="submit" id="button" /> -->
      <button onclick="sentMessage()">submits</button>
    </form>

    <p id="message">
      Please wait while connecting....<br />
      <small>Should not take longer than 10 seconds</small>
    </p>

    <ul id="list"></ul>
  </div>


  <style>
    body {
      font-family: Arial, Helvetica, sans-serif;
    }

    #root {
      max-width: 550px;
      margin: 0 auto;
    }
  </style>





  <script>

    const rss = document.getElementById('rss');
    const heapTotal = document.getElementById('heapTotal');
    const heapUsed = document.getElementById('heapUsed');
    const external = document.getElementById('external');
    const ButtonMessage = document.querySelector('#text');

    // will not use tls if the connection is not made over https
    const protocol = window.location.protocol.includes('https') ? 'wss' : 'ws'
    const ws = new WebSocket(`${protocol}://${location.host}`);





    // LISTEN DARI SERVER HANTAR KE CLIENT
    ws.onmessage = (event) => {
      // const data = JSON.parse(event.data);

      console.log("data-->", event.data)

      // ws.send('Hello World!');

      rss.textContent = event.data;
      // heapTotal.textContent = data.heapTotal;
      // heapUsed.textContent = data.heapUsed;
      // external.textContent = data.external;
    };

    // Listen for messages
    // ws.addEventListener('message', (event) => {
    //   console.log('Message from server ', event.data);
    // });




    const sentMessage = () => {
      if (!ws) {
        console.log("WebSocket error")
        return
      } else {
        // const message = JSON.stringify({ message: ButtonMessage.value })
        ws.send(ButtonMessage.value)
      }
    }

  </script>



</body>

</html>